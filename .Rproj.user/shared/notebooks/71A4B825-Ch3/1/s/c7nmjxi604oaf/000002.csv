"0","reticulate::repl_python()"
"2","Python 3.9.2 (/Users/chenpoming/opt/anaconda3/envs/r-reticulate/bin/python)
Reticulate 1.24 REPL -- A Python interpreter in R.
Enter 'exit' or 'quit' to exit the REPL and return to R.
"
"0","box = [1] * 34"
"0","box.extend([0] * 2966)"
"0","random.shuffle(box)"
"0",""
"0","def chi2(observed, expected):"
"0","    pearson_residuals = []"
"0","    for row, expect in zip(observed, expected):"
"0","        pearson_residuals.append([(observe - expect) ** 2 / expect"
"0","                                  for observe in row])"
"0","    # return sum of squares"
"0","    return np.sum(pearson_residuals)"
"0",""
"0","expected_clicks = 34 / 3"
"0","expected_noclicks = 1000 - expected_clicks"
"0","expected = [34 / 3, 1000 - 34 / 3]"
"0","chi2observed = chi2(clicks.values, expected)"
"0",""
"0","def perm_fun(box):"
"0","    sample_clicks = [sum(random.sample(box, 1000)),"
"0","                     sum(random.sample(box, 1000)),"
"0","                     sum(random.sample(box, 1000))]"
"0","    sample_noclicks = [1000 - n for n in sample_clicks]"
"0","    return chi2([sample_clicks, sample_noclicks], expected)"
"0",""
"0","perm_chi2 = [perm_fun(box) for _ in range(2000)]"
"0",""
"0","resampled_p_value = sum(perm_chi2 > chi2observed) / len(perm_chi2)"
"0","print(f'Observed chi2: {chi2observed:.4f}')"
"1","Observed chi2: 1.6659
"
"0","print(f'Resampled p-value: {resampled_p_value:.4f}')"
"1","Resampled p-value: 0.4805
"
"0","chisq, pvalue, df, expected = stats.chi2_contingency(clicks)"
"0","print(f'Observed chi2: {chisq:.4f}')"
"1","Observed chi2: 1.6659
"
"0","print(f'p-value: {pvalue:.4f}')"
"1","p-value: 0.4348
"
